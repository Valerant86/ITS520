<!-- index.html -->

<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
  <script src="./index.js"></script>
  
  <style>
    table, th, td {
      border: 1px solid;
    }
    
    #leftbox {
      float: left; 
      width: 33%;
      height: 300px;
    }
    
    #middlebox {
      float: left; 
      width: 33%;
      height: 300px;
    }
    
    #rightbox {
      float: right;
      width: 33%;
      height: 300px;
    }
    
    h1 {
      color: green;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1> Air Quality XGBoost </h1>

  <div id="boxes1">
    <input type="text" id="box1" value="96.83"> Particulate Matter 2.5 (PM2.5) <br/>
    <input type="text" id="box2" value="139.36"> articulate Matter 10 (PM10) <br/>
    <input type="text" id="box3" value="1.6"> Nitrogen Monoxide (NO)  <br/>
    <input type="text" id="box4" value="25.65"> Nitrogen Dioxide (NO2) <br/>
    <input type="text" id="box5" value="14.99" > Nitrogen X (NOx) <br/>
    <input type="text" id="box6" value="15.12"> Ammonia (NH3) <br/>
    <input type="text" id="box7" value="0.11"> Carbon Monoxide (CO) <br/>
    <input type="text" id="box8" value="16.54"> Sulfur Dioxide (SO2) <br/>
    <input type="text" id="box9" value="117.21"> Ground-Level Ozone (O3) <br/>
    <input type="text" id="box10" value="0.29" > Benzene <br/>
    <input type="text" id="box11" value="4.45"> Toluene <br/>
    <input type="text" id="box12" value="0.07"> Xylene <br/>
  </div> 
      
  <div>
    <input style="background-color: blue" type="button" value="Run" onclick="runExample()"/>
  </div>

  <div id="boxes2">
    <h2> Air Quality Index (AQI) </h2>
    <div id="predictions">
      <!-- AQI value will be displayed here -->
    </div>
  </div>

  <script>
    // Your JavaScript code goes here
    async function runExample() {
      // Fetch values from input boxes
      var x = new Float32Array(12);
      for (let i = 1; i <= 12; i++) {
        x[i - 1] = parseFloat(document.getElementById(`box${i}`).value);
      }

      // Create the input tensor
      let tensorX = new ort.Tensor('float32', x, [1, 12]);
      let feeds = { float_input: tensorX };

      // Load the ONNX model
      let session = await ort.InferenceSession.create('xgboost_AirQuality_ort.onnx');

      // Run the model and get the result
      let result = await session.run(feeds);
      let outputData = result.variable.data;

      // Format the output value
      outputData = parseFloat(outputData).toFixed(2);

      // Display the output value
      let predictions = document.getElementById('predictions');
      predictions.innerHTML = ` <hr> Got an output tensor with values: <br/>
       <table>
         <tr>
           <td>  Rating of Air Quality  </td>
           <td id="td0">  ${outputData}  </td>
         </tr>
      </table>`;

      // Change the background color based on the output value
      var boxColor = getBoxColor(outputData);
      predictions.style.backgroundColor = boxColor;
    }

    function getBoxColor(aqi) {
    
      if (aqi <= 50) {
        return "green"; // Good
      } else if (aqi <= 100) {
        return "yellow"; // Moderate
      } else if (aqi <= 150) {
        return "orange"; // Unhealthy for sensitive groups
      } else if (aqi <= 200) {
        return "red"; // Unhealthy
      } else if (aqi <= 300) {
        return "purple"; // Very Unhealthy
      } else {
        return "maroon"; // Hazardous
      }
    }
  </script>
</body>
</html>
